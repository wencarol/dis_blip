| distributed init (rank 1, word 4): env://
| distributed init (rank 3, word 4): env://
| distributed init (rank 0, word 4): env://
| distributed init (rank 2, word 4): env://
Creating retrieval dataset
Using downloaded and verified file: annotation/flickr30k_val.json
Using downloaded and verified file: annotation/flickr30k_test.json
Creating model
reshape position embedding from 196 to 576
reshape position embedding from 196 to 576
load checkpoint from https://storage.googleapis.com/sfr-vision-language-research/BLIP/models/model_base.pth
missing keys:
['idx_queue', 'ptr_queue']
Start training
Train Epoch: [0]  [   0/1132]  eta: 6:03:47  lr: 0.000010  loss_itm: 1.8982  loss_ita: 22.5708  time: 19.2819  data: 10.8750  max mem: 22915
Train Epoch: [0]  [  50/1132]  eta: 1:44:00  lr: 0.000010  loss_itm: 0.6835  loss_ita: 8.0513  time: 5.4984  data: 0.0002  max mem: 24359
Train Epoch: [0]  [ 100/1132]  eta: 1:36:58  lr: 0.000010  loss_itm: 0.6667  loss_ita: 8.1609  time: 5.5075  data: 0.0002  max mem: 24359
Train Epoch: [0]  [ 150/1132]  eta: 1:31:37  lr: 0.000010  loss_itm: 0.6347  loss_ita: 9.5768  time: 5.5242  data: 0.0003  max mem: 24359
Train Epoch: [0]  [ 200/1132]  eta: 1:26:37  lr: 0.000010  loss_itm: 0.6468  loss_ita: 8.8497  time: 5.5123  data: 0.0002  max mem: 24359
Train Epoch: [0]  [ 250/1132]  eta: 1:21:48  lr: 0.000010  loss_itm: 0.6295  loss_ita: 8.8778  time: 5.5229  data: 0.0003  max mem: 24359
Train Epoch: [0]  [ 300/1132]  eta: 1:17:04  lr: 0.000010  loss_itm: 0.6602  loss_ita: 8.7915  time: 5.5216  data: 0.0003  max mem: 24359
Train Epoch: [0]  [ 350/1132]  eta: 1:12:23  lr: 0.000010  loss_itm: 0.6643  loss_ita: 8.9191  time: 5.5281  data: 0.0003  max mem: 24359
Train Epoch: [0]  [ 400/1132]  eta: 1:07:43  lr: 0.000010  loss_itm: 0.6191  loss_ita: 9.4241  time: 5.5326  data: 0.0002  max mem: 24359
Train Epoch: [0]  [ 450/1132]  eta: 1:03:04  lr: 0.000010  loss_itm: 0.6369  loss_ita: 9.6508  time: 5.5280  data: 0.0014  max mem: 24359
Train Epoch: [0]  [ 500/1132]  eta: 0:58:25  lr: 0.000010  loss_itm: 0.6224  loss_ita: 9.3045  time: 5.5217  data: 0.0003  max mem: 24359
Train Epoch: [0]  [ 550/1132]  eta: 0:53:47  lr: 0.000010  loss_itm: 0.6342  loss_ita: 8.9288  time: 5.5252  data: 0.0003  max mem: 24359
